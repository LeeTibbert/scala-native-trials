name: BL3.2 Run Scala Native tests on macOS
on:
  workflow_dispatch:

#  schedule:
#    - cron: '0 * * * *'

  
jobs:
  macOS-bl2:
    name: macOs bl3
    runs-on: macos-10.15
## Read https://github.com/actions/virtual-environments/blob/main/images\
##     /macos/macos-10.15-Readme.md to see what software is stock in the soup.

    steps:
      - uses: actions/checkout@v2

      - name: macOS - bl2 prologue

        run: |
          echo "Hello World from maybe macOS"
          echo "$(uname -a)"

## 2021-03-12 17:24 -0500 llvm 11 already installed, 
## Looks like java 8 compiler is also installed.

## Someday may want to actively check these versions
#          which javac

      - name: macOS - Log active software versions
        run: |
          clang --version
          javac -version

## 2021-03-12 17:42 -0500 Goal - install java 8 & Sbt 1.4.9
## Use stock sbt launcher, not sbt-extras or such. Avoid schism.

      - name: Install sbt
        run: |
          brew install sbt
          sbt --version

## TODO:
##       - rework log file handling
##       - rework Java handling to be explicitly J8. (unless I do
##         a fail fast check above.
##       - If the logfile is going to persist (as an artifact, rather
##         than just being echoed


      - name: Run Scala Native tests
        env:
          ACTION: test-runtime
          SCALA_VER="2.12.13" # scripted-tests only runs on 2.12
          SCALANATIVE_MODE: debug
        run: |
          sbt -no-colors -J-Xmx5G \
	  "++$SCALA_VER" \
          "$ACTION" 

# -30- #
